# 5장 책임 할당하기

- 책임 주도 설계
    - 데이터 중심의 설계 → 책임 중심의 설계 전환을 위한 두가지 원칙
        - 데이터보다 행동을 먼저 결정하라
        - 협력이라는 문맥안에서 책임을 결정하라
    - 위 두가지 원칙의 핵심은 설계를 진행하는 동안 데이터가 아니라 객체의 책임과 협력에 초점을 맞추라는 것이다.
    - 대안 : 리팩터링
- 적절한 책임
    - 협력이라는 문맥을 고려해야한다. 협력이라는 문맥에서 적절한 책임이란 곧 클라이언트의 관점에서 적절한 책임을 의미한다.
    - 메시지를 결정한 후에 내부 데이터에 관해 고민하기 시작한다.
- GRASP 패턴
    - Information expert(정보 전문가)패턴
        - 책임을 수행할 정보를 알고 있는 객체에게 책임을 할당하는 것
        - ⭐️ 정보 ≠ 데이터
        - ‘예매하라’ 라는 메시지가 있다면, 이 정보를 알고 있는 ‘상영’ 이라는 도메인이 적합할 것임. 이유는 영화 정보, 상영 시간, 상영 순번 등 필요한 정보들을 알고 있기 때문임.
    - Low coupling(낮은 결합도) 패턴
        - Screening이 DiscountCondition과 협력할 경우 결합도가 추가된다.
            - Movie가 DiscountCondition의 목록을 속성으로 포함하고 있기 때문임.
        - 따라서 Movie가 DiscountCondition과 협력하는 것이 이 패턴에서 협력하는 것이 더 나은 설계인 것이다.
    - High cohesion(높은 응집도) 패턴
        - Screening이 DiscountCondition과 협력할 경우 영화 요금 계산 관련된 책임을 떠안아야한다.
        - 그렇다면, 가장 중요한 책임인 예매를 생성하는 것에 영화 요금 계산 관련된 책임이 추가되니 좋은 설계가 아니다.
        - 낮은 결합도 패턴과 높은 응집도 패턴을 생각하며 설계를 한다면 재사용 가능하고 유연한 설계를 할 수 있을 것이다.
    - Creator(창조자) 패턴
        - 무언가를 생성할 때, 그 도메인을 잘 알고 있거나, 긴밀하게 사용하거나, 초기화에 필요한 도메인을 선택하여 생성하는 책임을 부여한다.
    - Polymorphism(다형성) 패턴
        - 순번조건, 기간조건을 Movie가 모두 알고 있어야 하는데 설계의 관점에서 전체적인 결합도가 높아진 것이다.
        - 이를 해결하기 위해서는 추상클래스나 인터페이스를 사용해야 한다.
            - 추상클래스: 역할을 대체할 클래스들 사이에서 구현을 공유해야 할 필요가 있다면 사용
            - 인터페이스: 역할을 대체하는 객체들의 책임만 정의하고 싶다면 사용
    - Protected variations(변경 보호) 패턴
        - 다형성 패턴에서 인터페이스를 사용하는 경우 따라오는 패턴
        - DisCountCondition에 타입을 추가하더라도 Movie는 영향 받지 않는다.
        - 캡슐화를 의미

        ![chatper5-1](https://github.com/gro-w-up/object/assets/50124623/5cf312ba-03c0-40a3-8840-9d3e33e7c4c2)
        
- 분리
    - 클래스 응집도 판단하기
        - 하나 이상의 이유로 변경이 되어야한다면 응집도가 낮다. 그렇기 때문에 변경의 이유를 기준으로 클래스를 분리하라
    - 타입분리
        - DiscountCondition의 순번 조건, 기간 조건을 각 다른 클래스로 분리하여 응집도가 향상시킴.

---
## 예상 질문
Q1. 추상클래스와 인터페이스는 언제 사용해야 하는가요?
- 추상클래스: 역할을 대체할 클래스들 사이에서 구현을 공유해야 할 필요가 있다면 사용
- 인터페이스: 역할을 대체하는 객체들의 책임만 정의하고 싶다면 사용

Q2. 결합도와 응집도에 설명해주세요.
- 결합도(Coupling) : 서로 다른 모듈 간에 상호 의존하는 정도
- 응집도(Cohesion) : 한 모듈 내부의 처리 요소들이 서로 관련되어 있는 정도
Q2-1. 결합도가 높고 응집도가 낮다면 무엇을 해야하나요?
